Лабораторная работа 4

Тема: Многопоточность и синхронизация потоков

Цель работы: Изучить проблему синхронизации потоков, научиться выявлять и предотвращать взаимоблокировки (deadlock).

Реализованные задачи

1. Обедающие философы (Dining Philosophers)
Цель: избежать deadlock и starvation.
Реализовано:
- версия с deadlock (демонстрация проблемы);
- версия без deadlock (исправление через порядок взятия вилок).
Используется: lock, многопоточность.

2. Задача о спящем парикмахере (Sleeping Barber)
Цель: смоделировать поведение парикмахерской через многопоточность.
Особенности: ограниченное количество мест ожидания.
Используется: SemaphoreSlim, CancellationToken.

3. Производитель–Потребитель (Producer–Consumer)
Цель: обеспечить правильную синхронизацию доступа к общему буферу.
Реализовано:
- решение с использованием BlockingCollection (готовое);
- решение с использованием SemaphoreSlim + lock (самописное).
Буфер: ограниченная очередь.

Ключевые понятия

Race Condition (состояние гонки)
Возникает, когда несколько потоков обращаются к общим данным без синхронизации.
Пример: несинхронизированный доступ к счётчику в тестах.

Deadlock (взаимная блокировка)
Ситуация, когда два или более потока ждут ресурсы, занятые друг другом.
Пример: первая версия задачи «Обедающие философы».

Starvation (голодание)
Ситуация, когда поток долго не может получить доступ к ресурсу.
Предотвращение: более честные алгоритмы планирования и аккуратная синхронизация.

Синхронизирующие примитивы

lock (Monitor)
Базовый механизм синхронизации.
Позволяет войти в критическую секцию только одному потоку.
Используется в задачах «Обедающие философы» и «Производитель–Потребитель».

SemaphoreSlim
Ограничивает количество потоков, которые могут войти в критическую секцию.
Используется в задачах «Спящий парикмахер» и «Производитель–Потребитель».

Mutex
Аналогичен lock, но может быть именованным и использоваться между процессами.
В данной работе не использовался (можно добавить в качестве расширения).

BlockingCollection
Потокобезопасная коллекция для паттерна производитель–потребитель.
Автоматически блокирует производителей при переполнении и потребителей при опустошении.
Используется в задаче «Производитель–Потребитель».

Инструкция по запуску

cd lab04
dotnet test Lab04.Tests/Lab04.Tests.csproj
dotnet run --project Lab04/Lab04.csproj